# 机器学习基础

机器学习（Machine Learning，ML）是人工智能的核心技术，让计算机能够从数据中自动学习和改进。

## 什么是机器学习

### 定义

> 机器学习是一种让计算机在没有明确编程的情况下，通过经验自动改进的技术。

### 核心思想

```
数据 + 算法 → 模型 → 预测/决策
```

不是告诉计算机具体规则，而是让它从数据中学习规则。

## 机器学习的类型

### 1. 监督学习（Supervised Learning）

**定义**：给定输入和正确答案，学习输入到输出的映射关系。

**特点**：
- 有标注数据（带正确答案）
- 学习输入→输出的函数
- 最常用的机器学习方法

**应用场景**：
- 📧 **垃圾邮件分类**：邮件 → 垃圾/正常
- 🏠 **房价预测**：房屋特征 → 价格
- 🩺 **疾病诊断**：症状 → 疾病类型
- 📸 **图像识别**：图片 → 物体类别

**算法示例**：
- 线性回归
- 逻辑回归
- 决策树
- 神经网络
- 支持向量机（SVM）

**例子**：

```python
# 训练数据（房子面积 → 价格）
训练数据 = [
    (50㎡, 100万),
    (80㎡, 150万),
    (100㎡, 200万),
    (120㎡, 240万)
]

# 训练模型
模型 = 学习(训练数据)

# 预测
预测价格 = 模型.predict(90㎡)  # 预测约170万
```

### 2. 无监督学习（Unsupervised Learning）

**定义**：只有输入数据，没有标签，让机器自己发现数据中的模式。

**特点**：
- 无标注数据
- 发现数据内在结构
- 探索性分析

**应用场景**：
- 👥 **用户分群**：将用户分成不同群体
- 📰 **新闻聚类**：自动将新闻分类
- 🛒 **推荐系统**：发现相似商品
- 🔍 **异常检测**：发现异常行为

**算法示例**：
- K-means聚类
- 层次聚类
- 主成分分析（PCA）
- 自编码器

**例子**：

```python
# 输入：客户购买数据（无标签）
客户数据 = [购买记录1, 购买记录2, ...]

# 聚类分析
模型 = K均值聚类(数据=客户数据, 聚类数=3)

# 结果：自动将客户分为3组
# 群体1: 高消费客户
# 群体2: 中等消费客户
# 群体3: 低消费客户
```

### 3. 强化学习（Reinforcement Learning）

**定义**：通过与环境互动，通过试错学习最优策略。

**特点**：
- 延迟奖励
- 序列决策
- 探索与利用平衡

**应用场景**：
- 🎮 **游戏AI**：AlphaGo、Dota 2
- 🤖 **机器人控制**：行走、抓取
- 🚗 **自动驾驶**：驾驶策略
- 💰 **量化交易**：投资决策

**核心概念**：
- **Agent（智能体）**：学习者
- **Environment（环境）**：交互对象
- **Action（动作）**：可执行的操作
- **Reward（奖励）**：反馈信号
- **State（状态）**：当前情况

**流程**：

```
状态 → 选择动作 → 执行 → 获得奖励 → 更新策略 → 循环
```

**例子**：

```python
# 训练游戏AI
while 游戏未结束:
    当前状态 = 观察游戏画面()
    动作 = AI选择动作(当前状态)
    执行(动作)
    奖励 = 获得分数()
    AI学习(状态, 动作, 奖励)
```

## 机器学习的工作流程

### 1. 数据收集

```
收集相关数据 → 整理 → 清洗 → 标注（如需要）
```

**数据来源**：
- 公开数据集
- 企业内部数据
- 爬虫采集
- 传感器收集

### 2. 数据预处理

**清洗数据**：
- 处理缺失值
- 删除重复数据
- 修正错误数据

**特征工程**：
- 选择重要特征
- 创建新特征
- 特征缩放/标准化

```python
# 数据预处理示例
数据 = 加载数据()
数据 = 去除缺失值(数据)
数据 = 标准化(数据)
特征, 标签 = 分离特征和标签(数据)
```

### 3. 选择模型

根据问题类型选择合适的算法：

**分类问题**：
- 逻辑回归
- 决策树
- 随机森林
- 神经网络

**回归问题**：
- 线性回归
- 多项式回归
- 神经网络

**聚类问题**：
- K-means
- DBSCAN
- 层次聚类

### 4. 训练模型

```python
# 分割数据
训练集, 测试集 = 分割数据(数据, 比例=0.8)

# 训练模型
模型 = 创建模型()
模型.train(训练集)
```

### 5. 评估模型

**分类指标**：
- 准确率（Accuracy）
- 精确率（Precision）
- 召回率（Recall）
- F1分数

**回归指标**：
- 均方误差（MSE）
- 平均绝对误差（MAE）
- R²分数

```python
# 评估
预测结果 = 模型.predict(测试集)
准确率 = 计算准确率(预测结果, 真实标签)
print(f"准确率: {准确率}%")
```

### 6. 优化调参

**超参数调优**：
- 学习率
- 网络层数
- 神经元数量
- 正则化参数

**方法**：
- 网格搜索
- 随机搜索
- 贝叶斯优化

### 7. 部署应用

```
模型 → 保存 → 部署到服务器 → API接口 → 实际应用
```

## 关键概念

### 过拟合与欠拟合

**欠拟合（Underfitting）**：
- 模型太简单
- 训练不充分
- 表现：训练和测试都差

**过拟合（Overfitting）**：
- 模型太复杂
- 记住了训练数据的噪声
- 表现：训练好，测试差

**解决方法**：
- 增加/减少数据
- 调整模型复杂度
- 正则化
- 交叉验证
- Dropout

### 偏差与方差

**偏差（Bias）**：
- 模型假设与真实情况的差距
- 高偏差 → 欠拟合

**方差（Variance）**：
- 模型对训练数据变化的敏感度
- 高方差 → 过拟合

**目标**：
```
低偏差 + 低方差 = 好模型
```

### 特征工程

**特征选择**：
- 选择最相关的特征
- 降低维度
- 提高效率

**特征创造**：
- 组合现有特征
- 提取新信息
- 增强表达能力

**特征缩放**：
```python
# 标准化：均值0，标准差1
标准化(数据)

# 归一化：缩放到0-1
归一化(数据)
```

## 常用算法

### 线性回归

```python
# 预测连续值
y = w₁x₁ + w₂x₂ + ... + b

# 例：房价预测
价格 = 系数₁ × 面积 + 系数₂ × 房间数 + 常数
```

### 逻辑回归

```python
# 二分类问题
概率 = sigmoid(w₁x₁ + w₂x₂ + ... + b)

# 例：垃圾邮件分类
是否垃圾 = sigmoid(特征加权和)
```

### 决策树

```
if 特征1 > 阈值1:
    if 特征2 > 阈值2:
        预测 = 类别A
    else:
        预测 = 类别B
else:
    预测 = 类别C
```

### K-近邻（KNN）

```python
# 根据最近的K个邻居投票
预测 = 最近K个样本中最多的类别
```

## 实践示例

### 例子：鸢尾花分类

```python
# 1. 导入库
from sklearn import datasets
from sklearn.model_selection import train_test_split
from sklearn.tree import DecisionTreeClassifier
from sklearn.metrics import accuracy_score

# 2. 加载数据
iris = datasets.load_iris()
X = iris.data  # 特征
y = iris.target  # 标签

# 3. 分割数据
X_train, X_test, y_train, y_test = train_test_split(
    X, y, test_size=0.3, random_state=42
)

# 4. 创建并训练模型
model = DecisionTreeClassifier()
model.fit(X_train, y_train)

# 5. 预测和评估
predictions = model.predict(X_test)
accuracy = accuracy_score(y_test, predictions)
print(f"准确率: {accuracy * 100:.2f}%")
```

## 机器学习工具

### Python库

**核心库**：
- 🐼 **Pandas**：数据处理
- 🔢 **NumPy**：数值计算
- 📊 **Matplotlib**：数据可视化

**机器学习库**：
- 🤖 **Scikit-learn**：经典算法
- 🧠 **TensorFlow**：深度学习
- 🔥 **PyTorch**：深度学习
- ⚡ **XGBoost**：梯度提升

### 开发环境

- 📓 **Jupyter Notebook**：交互式开发
- 🐍 **Anaconda**：环境管理
- ☁️ **Google Colab**：云端GPU

## 学习路径

### 初级阶段

1. ✅ Python编程基础
2. ✅ NumPy和Pandas
3. ✅ 机器学习概念
4. ✅ Scikit-learn实践

### 中级阶段

1. ✅ 特征工程
2. ✅ 模型调优
3. ✅ 集成学习
4. ✅ 实际项目

### 高级阶段

1. ✅ 深度学习
2. ✅ 大规模数据处理
3. ✅ 模型部署
4. ✅ MLOps

## 常见问题

### Q: 需要多少数据？

**A**: 取决于问题复杂度：
- 简单问题：数百到数千样本
- 中等问题：数万样本
- 复杂问题（深度学习）：数十万到数百万样本

### Q: 如何选择算法？

**A**: 考虑因素：
- 问题类型（分类/回归/聚类）
- 数据规模
- 特征数量
- 准确性要求
- 可解释性需求

### Q: 机器学习 vs 深度学习？

**A**: 
- **机器学习**：更广泛，包含传统算法
- **深度学习**：机器学习的子集，使用神经网络

## 下一步

- 🧠 [深度学习原理](ai/fundamentals/deep-learning.md)
- 🔬 [神经网络详解](ai/fundamentals/neural-networks.md)
- 🐍 [Python与AI](ai/fundamentals/python-for-ai.md)
- 🛠️ [AI工具](../tools/README.md)

---

?> **关键要点**：机器学习的本质是让机器从数据中学习模式，而不是硬编码规则。数据质量和特征工程往往比算法选择更重要！

